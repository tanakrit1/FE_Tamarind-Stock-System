import{r as p,o as J,v as E,f as c,j as _,k as e,l as h,D as C,x as u,A as g,B as K,y as k,F as S,z as P,C as Q}from"./index-BfEDlx2e.js";import{b as L,_ as R,a as W}from"./pagination-page-BpupLFiI.js";import{_ as X}from"./button-primary-outline-DA8sDgzx.js";import{p as D,d as N,s as x}from"./thai_provinces-BD6VM2Cq.js";import{_ as A}from"./master-customer-D3cMHzgD.js";const Y={class:"flex md:justify-center"},Z={class:"sm:w-1/1 md:w-2/3 flex flex-col mb-10 space-y-10"},ee={class:"flex justify-between"},te=e("div",{class:"flex space-x-3"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 20 20"},[e("path",{fill:"#A2422C",d:"M17 7v2.401a3 3 0 0 0-3.727 4.609A2.5 2.5 0 0 0 11 16.5q0 .25.038.5H5.5A2.5 2.5 0 0 1 3 14.5V7zm-2.5-4A2.5 2.5 0 0 1 17 5.5V6H3v-.5A2.5 2.5 0 0 1 5.5 3zm3 9a2 2 0 1 1-4 0a2 2 0 0 1 4 0m1.5 4.5c0 1.245-1 2.5-3.5 2.5S12 17.75 12 16.5a1.5 1.5 0 0 1 1.5-1.5h4a1.5 1.5 0 0 1 1.5 1.5"})]),e("span",{class:"text-2xl font-bold text-red-800"},"กำหนดข้อมูลลูกค้า")],-1),se={class:"flex space-x-3"},ie={class:"rounded-xl mb-10 overflow-auto"},le={class:"flex justify-end"},ae={id:"modal-supplier",class:"modal"},oe={class:"modal-box w-11/12 max-w-3xl"},ne={class:"font-bold text-lg"},de=e("hr",{class:"mt-2",style:{border:"1px solid #c2796a"}},null,-1),ue={class:"py-4 flex flex-wrap"},re={key:0,class:"basis-1/2 px-3 space-y-2 mb-3"},ce=e("label",{class:"font-semibold"},"รหัสลูกค้า",-1),_e=e("br",null,null,-1),pe={class:"basis-1/2 px-3 space-y-2 mb-3"},ve=e("label",{class:"font-semibold"},"ชื่อ",-1),me=e("br",null,null,-1),be={class:"basis-1/2 px-3 space-y-2 mb-3"},fe=e("label",{class:"font-semibold"},"สกุล",-1),he=e("br",null,null,-1),ge={class:"basis-1/2 px-3 space-y-2 mb-3"},xe=e("label",{class:"font-semibold"},"เบอร์โทร",-1),ye=e("br",null,null,-1),we={class:"basis-1/2 px-3 space-y-2 mb-3"},Ce=e("label",{class:"font-semibold"},"ที่อยู่",-1),De=e("br",null,null,-1),Ne={class:"basis-1/2 px-3 space-y-2 mb-3"},ze=e("label",{class:"font-semibold"},"จังหวัด",-1),Ve=e("br",null,null,-1),Me=e("option",{value:""},"------เลือก------",-1),ke=["value"],Se={class:"basis-1/2 px-3 space-y-2 mb-3"},Pe=e("label",{class:"font-semibold"},"อำเภอ",-1),Ae=e("br",null,null,-1),Ue=e("option",{value:""},"------เลือก------",-1),Ie=["value"],$e={class:"basis-1/2 px-3 space-y-2 mb-3"},Be=e("label",{class:"font-semibold"},"ตำบล",-1),je=e("br",null,null,-1),Ee=e("option",{value:""},"------เลือก------",-1),Le=["value"],Fe={class:"basis-1/2 px-3 space-y-2 mb-3"},He=e("label",{class:"font-semibold"},"รหัสไปรษณีย์",-1),Oe=e("br",null,null,-1),qe={class:"modal-action"},We={__name:"index",setup(Te){const r=p({page:1,limit:5,totalPage:0}),F=[{field:"specialID",label:"รหัส",width:"10%"},{field:"firstName",label:"ชื่อ",width:"15%"},{field:"lastName",label:"สกุล",width:"15%"},{field:"address",label:"ที่อยู่",width:"15%"},{field:"subDistric",label:"ตำบล",width:"15%"},{field:"distric",label:"อำเภอ",width:"15%"},{field:"province",label:"จังหวัด",width:"15%"},{field:"zipCode",label:"ไปรษณีย์",width:"10%"}],U=p([]),d=p({status:!1,title:"",body:""}),y=p("add"),o=p(null),v=p({province:[],district:[],subDistrict:[]}),i=p({in_specialID:"",in_firstName:"",in_lastName:"",in_phone:"",in_province:"",in_district:"",in_subDistrict:"",in_zipCode:"",in_address:""});J(async()=>{E.commit("setStatusLoading",!0),v.value.province=D.sort((a,s)=>a.name_th.localeCompare(s.name_th)),await w(),d.value={status:!1,title:"",body:""},E.commit("setStatusLoading",!1)});const H=()=>{d.value.status=!1},O=()=>{i.value={in_specialID:"",in_firstName:"",in_lastName:"",in_phone:"",in_province:"",in_district:"",in_subDistrict:"",in_zipCode:"",in_address:""}},w=async()=>{const a={page:r.value.page,limit:r.value.limit};await A.search(a,s=>{U.value=s.data,r.value.totalPage=s.metadata.totalPage})},q=a=>{r.value.page=a,w()},I=async a=>{const s=N.filter(t=>t.province_id==a);v.value.district=s,i.value.in_district="",i.value.in_subDistrict="",i.value.in_zipCode=""},$=async a=>{const s=x.filter(t=>t.amphure_id==a);v.value.subDistrict=s,i.value.in_subDistrict="",i.value.in_zipCode=""},B=async a=>{const s=x.find(t=>t.id==a).zip_code;i.value.in_zipCode=s},T=a=>{o.value=a,j("edit")},j=async a=>{var s,t,n;if(y.value=a,a==="add")O();else{const m=(s=D.find(l=>l.name_th==o.value.province))==null?void 0:s.id,b=(t=N.find(l=>l.name_th==o.value.distric&&l.province_id==m))==null?void 0:t.id,f=(n=x.find(l=>l.name_th==o.value.subDistric&&l.amphure_id==b))==null?void 0:n.id;await I(m),await $(b),await B(f),i.value={in_specialID:o.value.specialID,in_firstName:o.value.firstName,in_lastName:o.value.lastName,in_phone:o.value.phone,in_province:m,in_district:b,in_subDistrict:f,in_zipCode:o.value.zipCode,in_address:o.value.address}}document.getElementById("modal-supplier").showModal()},G=async()=>{var a,s,t,n,m,b;if(y.value==="add"){const f={firstName:i.value.in_firstName,lastName:i.value.in_lastName,address:i.value.in_address,subDistric:((a=x.find(l=>l.id==i.value.in_subDistrict))==null?void 0:a.name_th)||"",distric:((s=N.find(l=>l.id==i.value.in_district))==null?void 0:s.name_th)||"",province:((t=D.find(l=>l.id==i.value.in_province))==null?void 0:t.name_th)||"",zipCode:i.value.in_zipCode.toString(),phone:i.value.in_phone.toString()};await A.create(f,async l=>{if(l.statusCode===200)d.value={status:!0,title:"สำเร็จ",body:"บันทึกข้อมูลสำเร็จ"},z(),await w();else{const V=l.message.map(M=>`<li>${M}</li>`);d.value={status:!0,title:"กรุณาตรวจสอบ",body:V.join("")}}})}else{const f={firstName:i.value.in_firstName,lastName:i.value.in_lastName,address:i.value.in_address,subDistric:((n=x.find(l=>l.id==i.value.in_subDistrict))==null?void 0:n.name_th)||"",distric:((m=N.find(l=>l.id==i.value.in_district))==null?void 0:m.name_th)||"",province:((b=D.find(l=>l.id==i.value.in_province))==null?void 0:b.name_th)||"",zipCode:i.value.in_zipCode.toString(),phone:i.value.in_phone.toString()};await A.update(f,o.value.id,async l=>{if(l.statusCode===200)d.value={status:!0,title:"สำเร็จ",body:"บันทึกข้อมูลสำเร็จ"},z(),await w();else{const V=l.message.map(M=>`<li>${M}</li>`);d.value={status:!0,title:"กรุณาตรวจสอบ",body:V.join("")}}})}},z=()=>{document.getElementById("modal-supplier").close()};return(a,s)=>(c(),_("div",null,[e("div",Y,[e("div",Z,[e("div",ee,[te,e("div",se,[h(L,{label:"เพิ่มลูกค้า",icon:"plus",onClick:s[0]||(s[0]=t=>j("add"))})])]),e("div",ie,[h(R,{columns:F,rows:U.value,rowEdit:!0,onOnClickEdit:T},null,8,["rows"])]),e("div",le,[h(W,{currentPage:r.value.page,"onUpdate:currentPage":[s[1]||(s[1]=t=>r.value.page=t),q],totalPages:r.value.totalPage,limit:r.value.limit},null,8,["currentPage","totalPages","limit"])])])]),e("dialog",ae,[e("div",oe,[e("h3",ne,C(y.value==="add"?"เพิ่มลูกค้า":"แก้ไขลูกค้า"),1),de,e("div",ue,[y.value==="edit"?(c(),_("div",re,[ce,_e,u(e("input",{disabled:"","onUpdate:modelValue":s[2]||(s[2]=t=>i.value.in_specialID=t),type:"text",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3"},null,512),[[g,i.value.in_specialID]])])):K("",!0),e("div",pe,[ve,me,u(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>i.value.in_firstName=t),type:"text",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3"},null,512),[[g,i.value.in_firstName]])]),e("div",be,[fe,he,u(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>i.value.in_lastName=t),type:"text",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3"},null,512),[[g,i.value.in_lastName]])]),e("div",ge,[xe,ye,u(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>i.value.in_phone=t),type:"text",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3"},null,512),[[g,i.value.in_phone]])]),e("div",we,[Ce,De,u(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>i.value.in_address=t),type:"text",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3"},null,512),[[g,i.value.in_address]])]),e("div",Ne,[ze,Ve,u(e("select",{"onUpdate:modelValue":s[7]||(s[7]=t=>i.value.in_province=t),class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3",onChange:s[8]||(s[8]=t=>I(t.target.value))},[Me,(c(!0),_(S,null,P(v.value.province,(t,n)=>(c(),_("option",{key:n,value:t.id},C(t.name_th),9,ke))),128))],544),[[k,i.value.in_province]])]),e("div",Se,[Pe,Ae,u(e("select",{"onUpdate:modelValue":s[9]||(s[9]=t=>i.value.in_district=t),class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3",onChange:s[10]||(s[10]=t=>$(t.target.value))},[Ue,(c(!0),_(S,null,P(v.value.district,(t,n)=>(c(),_("option",{key:n,value:t.id},C(t.name_th),9,Ie))),128))],544),[[k,i.value.in_district]])]),e("div",$e,[Be,je,u(e("select",{"onUpdate:modelValue":s[11]||(s[11]=t=>i.value.in_subDistrict=t),class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3",onChange:s[12]||(s[12]=t=>B(t.target.value))},[Ee,(c(!0),_(S,null,P(v.value.subDistrict,(t,n)=>(c(),_("option",{key:n,value:t.id},C(t.name_th),9,Le))),128))],544),[[k,i.value.in_subDistrict]])]),e("div",Fe,[He,Oe,u(e("input",{"onUpdate:modelValue":s[13]||(s[13]=t=>i.value.in_zipCode=t),type:"text",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3",readonly:""},null,512),[[g,i.value.in_zipCode]])])]),e("div",qe,[h(L,{label:"เพิ่ม",onClick:G}),h(X,{label:"ปิด",onClick:z})])])]),h(Q,{titleMessage:d.value.title,bodyMessage:d.value.body,status:d.value.status,onCloseAlertModal:H},null,8,["titleMessage","bodyMessage","status"])]))}};export{We as default};
