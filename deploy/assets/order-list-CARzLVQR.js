import{E as $,r as y,o as U,v as s,f as b,j as _,k as o,x as P,y as q,F as V,z as G,A as N,B as S,G as A,H as T,l as O,C as W,m as J,D as K}from"./index-BfEDlx2e.js";import{_ as F,a as Q}from"./pagination-page-BpupLFiI.js";import{_ as x}from"./deposit-export-B8sLj4JT.js";import{_ as I}from"./export-product-DQx4E2gf.js";import{_ as X}from"./master-products-CGZ8hcHS.js";import{E as Y}from"./exceljs.min-COGG1g5r.js";import"./button-primary-outline-DA8sDgzx.js";import"./_commonjsHelpers-Cpj98o6Y.js";const ee={class:"flex md:justify-center"},te={class:"sm:w-1/1 md:w-4/5 flex flex-col mb-5 space-y-2"},ae=J('<div class="flex justify-start"><div class="flex"><svg width="33" height="33" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.9436 1.25H13.0564C14.8942 1.24998 16.3498 1.24997 17.489 1.40314C18.6614 1.56076 19.6104 1.89288 20.3588 2.64124C21.1071 3.38961 21.4392 4.33856 21.5969 5.51098C21.75 6.65019 21.75 8.10583 21.75 9.94359V14.0564C21.75 15.8942 21.75 17.3498 21.5969 18.489C21.4392 19.6614 21.1071 20.6104 20.3588 21.3588C19.6104 22.1071 18.6614 22.4392 17.489 22.5969C16.3498 22.75 14.8942 22.75 13.0564 22.75H10.9436C9.10583 22.75 7.65019 22.75 6.51098 22.5969C5.33856 22.4392 4.38961 22.1071 3.64124 21.3588C2.89288 20.6104 2.56076 19.6614 2.40314 18.489C2.24997 17.3498 2.24998 15.8942 2.25 14.0564V9.94358C2.24998 8.10582 2.24997 6.65019 2.40314 5.51098C2.56076 4.33856 2.89288 3.38961 3.64124 2.64124C4.38961 1.89288 5.33856 1.56076 6.51098 1.40314C7.65019 1.24997 9.10582 1.24998 10.9436 1.25ZM6.71085 2.88976C5.70476 3.02502 5.12511 3.27869 4.7019 3.7019C4.27869 4.12511 4.02502 4.70476 3.88976 5.71085C3.75159 6.73851 3.75 8.09318 3.75 10V14C3.75 15.9068 3.75159 17.2615 3.88976 18.2892C4.02502 19.2952 4.27869 19.8749 4.7019 20.2981C5.12511 20.7213 5.70476 20.975 6.71085 21.1102C7.73851 21.2484 9.09318 21.25 11 21.25H13C14.9068 21.25 16.2615 21.2484 17.2892 21.1102C18.2952 20.975 18.8749 20.7213 19.2981 20.2981C19.7213 19.8749 19.975 19.2952 20.1102 18.2892C20.2484 17.2615 20.25 15.9068 20.25 14V10C20.25 8.09318 20.2484 6.73851 20.1102 5.71085C19.975 4.70476 19.7213 4.12511 19.2981 3.7019C18.8749 3.27869 18.2952 3.02502 17.2892 2.88976C16.2615 2.75159 14.9068 2.75 13 2.75H11C9.09318 2.75 7.73851 2.75159 6.71085 2.88976ZM7.25 8C7.25 7.58579 7.58579 7.25 8 7.25H16C16.4142 7.25 16.75 7.58579 16.75 8C16.75 8.41421 16.4142 8.75 16 8.75H8C7.58579 8.75 7.25 8.41421 7.25 8ZM7.25 12C7.25 11.5858 7.58579 11.25 8 11.25H16C16.4142 11.25 16.75 11.5858 16.75 12C16.75 12.4142 16.4142 12.75 16 12.75H8C7.58579 12.75 7.25 12.4142 7.25 12ZM7.25 16C7.25 15.5858 7.58579 15.25 8 15.25H13C13.4142 15.25 13.75 15.5858 13.75 16C13.75 16.4142 13.4142 16.75 13 16.75H8C7.58579 16.75 7.25 16.4142 7.25 16Z" fill="#A2422C"></path></g></svg><span class="text-2xl font-bold text-red-800">รายการสินค้านำออก</span></div></div>',1),le={class:"flex justify-center pb-5"},oe={class:"w-full bg-white rounded-xl py-5"},re={class:"grid grid-cols-2 gap-4 px-6 mt-3"},se={class:"flex flex-col"},ie=o("span",{class:"text-red-800 font-semibold"},"ชื่อสินค้า",-1),ue=["value"],de={class:"flex flex-col"},pe=o("span",{class:"text-red-800 font-semibold"},"ประเภทนำเข้าสินค้า",-1),ce=o("option",{selected:"",value:"ซื้อ-ขาย"},"ซื้อ-ขาย",-1),ne=o("option",{value:"แปรรูป"},"แปรรูป",-1),ve=o("option",{value:"ฝาก"},"ฝาก",-1),fe=[ce,ne,ve],me={class:"flex flex-col"},De=o("span",{class:"text-red-800 font-semibold"},"วันที่เริ่มต้น",-1),he={class:"flex flex-col"},ye=o("span",{class:"text-red-800 font-semibold"},"วันที่สิ้นสุด",-1),ge={key:0,class:"grid grid-cols-2 gap-4 px-6 mt-3"},be={class:"flex flex-col"},we=o("span",{class:"text-red-800 font-semibold"},"วันที่เลิกฝากเริ่มต้น",-1),_e={class:"flex flex-col"},Pe=o("span",{class:"text-red-800 font-semibold"},"วันที่เลิกฝากสิ้นสุด",-1),Ce={class:"flex justify-center py-5 space-x-3"},xe=o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[o("path",{fill:"currentColor","fill-rule":"evenodd",d:"M11.5 2.75a8.75 8.75 0 1 0 0 17.5a8.75 8.75 0 0 0 0-17.5M1.25 11.5c0-5.66 4.59-10.25 10.25-10.25S21.75 5.84 21.75 11.5c0 2.56-.939 4.902-2.491 6.698l3.271 3.272a.75.75 0 1 1-1.06 1.06l-3.272-3.271A10.21 10.21 0 0 1 11.5 21.75c-5.66 0-10.25-4.59-10.25-10.25","clip-rule":"evenodd"})],-1),Ne=o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 512 512"},[o("path",{d:"M256 48C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48zm0 336.1c-70.7 0-128-57.3-128-128.1s57.3-128.1 128-128.1v-37c0-6.4 7.1-10.2 12.4-6.7l72.9 52.6c4.9 3.3 4.7 10.6-.4 13.6L268 196.7c-5.3 3.1-12-.8-12-6.9v-41.9c-60.3 0-109.2 49.7-108.1 110.2 1.1 59.1 50.3 106.7 109.5 106 55.9-.7 101.8-43.7 106.3-99 .4-5.2 4.7-9.1 9.9-9.1 5.8 0 10.4 4.9 9.9 10.7-5.4 66-60.4 117.4-127.5 117.4z",fill:"#A2422C"})],-1),Se=o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24"},[o("path",{fill:"currentColor",d:"M3 10c0-3.771 0-5.657 1.172-6.828C5.343 2 7.229 2 11 2h2c3.771 0 5.657 0 6.828 1.172C21 4.343 21 6.229 21 10v4c0 3.771 0 5.657-1.172 6.828C18.657 22 16.771 22 13 22h-2c-3.771 0-5.657 0-6.828-1.172C3 19.657 3 17.771 3 14z",opacity:".5"}),o("path",{fill:"currentColor",d:"M16.519 16.501c.175-.136.334-.295.651-.612l3.957-3.958c.096-.095.052-.26-.075-.305a4.332 4.332 0 0 1-1.644-1.034a4.332 4.332 0 0 1-1.034-1.644c-.045-.127-.21-.171-.305-.075L14.11 12.83c-.317.317-.476.476-.612.651c-.161.207-.3.43-.412.666c-.095.2-.166.414-.308.84l-.184.55l-.292.875l-.273.82a.584.584 0 0 0 .738.738l.82-.273l.875-.292l.55-.184c.426-.142.64-.212.84-.308c.236-.113.46-.25.666-.412m5.849-5.809a2.163 2.163 0 1 0-3.06-3.059l-.126.128a.524.524 0 0 0-.148.465c.02.107.055.265.12.452c.13.375.376.867.839 1.33a3.5 3.5 0 0 0 1.33.839c.188.065.345.1.452.12a.525.525 0 0 0 .465-.148z"}),o("path",{fill:"currentColor","fill-rule":"evenodd",d:"M7.25 9A.75.75 0 0 1 8 8.25h6.5a.75.75 0 0 1 0 1.5H8A.75.75 0 0 1 7.25 9m0 4a.75.75 0 0 1 .75-.75h3a.75.75 0 0 1 0 1.5H8a.75.75 0 0 1-.75-.75m0 4a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 0 1.5H8a.75.75 0 0 1-.75-.75","clip-rule":"evenodd"})],-1),Ae={key:0,class:"mx-20"},Ie={class:"overflow-auto rounded-xl"},ke={class:"flex justify-end py-5"},je={__name:"order-list",setup(Le){$();const u=y({page:1,limit:10,totalPage:0}),M=p=>{u.page=p,L()},v=y({status:!1,title:"",body:""}),E=()=>{v.value.status=!1},Z=[{field:"specialID",label:"รหัส",width:"auto"},{field:"productName",label:"ชื่อสินค้า",width:"auto"},{field:"typeAction",label:"ประเภทสินค้านำออก",width:"auto"},{field:"productInPrice",label:"ราคารับซื้อ",width:"auto"},{field:"productOutPrice",label:"ราคาขายออก",width:"auto"},{field:"quantity",label:"ปริมาณการขาย",width:"auto"},{field:"priceTotal",label:"ราคารวม",width:"auto"},{field:"exportDate",label:"วันที่นำออก",width:"auto"},{field:"customerFirstName",label:"ชื่อ",width:"auto"},{field:"customerLastName",label:"สกุล",width:"auto"},{field:"customerPhone",label:"เบอร์โทร",width:"auto"},{field:"customerAddress",label:"ที่อยู่",width:"auto"},{field:"customerSubDistrict",label:"ตำบล",width:"auto"},{field:"customerDistrict",label:"อำเภอ",width:"auto"},{field:"customerProvince",label:"จังหวัด",width:"auto"},{field:"customerZipCode",label:"ไปรษณีย์",width:"auto"}],j=[{field:"specialID",label:"รหัส",width:"auto"},{field:"productName",label:"ชื่อสินค้า",width:"auto"},{field:"typeAction",label:"ประเภทสินค้านำออก",width:"auto"},{field:"quantity_import",label:"ปริมาณฝากเข้า",width:"auto"},{field:"productInPrice",label:"ราคารับซื้อ",width:"auto"},{field:"productOutPrice",label:"ราคาขายออก",width:"auto"},{field:"priceDeposit",label:"ค่าฝาก",width:"auto"},{field:"quantity",label:"ปริมาณการขาย",width:"auto"},{field:"remain",label:"ประมาณคงเหลือ",width:"auto"},{field:"priceDeposit",label:"ราคารวม",width:"auto"},{field:"periodDate",label:"วันที่สิ้นสุดการฝาก",width:"auto"},{field:"supplierFirstName",label:"ชื่อ",width:"auto"},{field:"supplierLastName",label:"สกุล",width:"auto"},{field:"supplierPhone",label:"เบอร์โทร",width:"auto"},{field:"supplierAddress",label:"ที่อยู่",width:"auto"},{field:"supplierSubDistrict",label:"ตำบล",width:"auto"},{field:"supplierDistrict",label:"อำเภอ",width:"auto"},{field:"supplierProvince",label:"จังหวัด",width:"auto"},{field:"supplierZipCode",label:"ไปรษณีย์",width:"auto"}],d=y([]);let c=null,h=null;const i=y(!1),r=y(!1),f=y(!1),a=y({startDate:"",endDate:"",startPeriodDate:"",endPeriodDate:""}),m=y({in_productName:""}),w=y({in_exportType:"ซื้อ-ขาย"}),R=async()=>{const p={page:1,limit:1e4,sortField:"id",sortType:"ASC",filterModel:{logicOperator:"and",items:[]}};await X.search(p,l=>{if(l.statusCode===200)console.log("response --> ",l),m.value=l.data.map(t=>({id:t.id,specialID:t.specialID,productName:t.name,typeAction:t.type,productPrice:t.price,quantity:t.quantity}));else{const t=l.message.map(e=>`<li>${e}</li>`);modalAlert.value={status:!0,title:"กรุณาตรวจสอบ",body:t.join("")}}})},k=async()=>{if(f.value==!0){if(a.value.startDate!=""&&a.value.endDate!=""){if(console.log("currentDate.value.startDate --> ",a.value.startDate),console.log("currentDate.value.endDate --> ",a.value.endDate),g()){s.commit("setStatusLoading",!0);const l={page:i.value?1:u.value.page,limit:i.value?1e4:u.value.limit,sortField:"product_specialID",sortType:"ASC",filterModel:{logicOperator:"and",items:[{field:"product_name",operator:"equals",value:m.value.in_productName},{field:"exportDate",operator:"between",value:[a.value.startDate,a.value.endDate]}]}};console.log("body --> ",l),await x.exportSearch(l,t=>{if(t.statusCode===200)t.data.length>0?(r.value=!0,f.value=!0,s.commit("setStatusLoading",!1),console.log("_apiDepositExport--> ",t),c=t.data.map(e=>({specialID:e.product.specialID,productName:e.product.name,productInPrice:e.product.price,productOutPrice:e.product.priceOut,priceDeposit:e.Import_Deposit.price,priceTotalDeposit:e.Import_Deposit.price,remain:e.Import_Deposit.remain,quantity_import:e.Import_Deposit.quantity,quantity:e.quantity,periodDate:e.Import_Deposit.periodDate,supplierFirstName:e.supplier.firstName,supplierLastName:e.supplier.lastName,supplierPhone:e.supplier.phone,supplierAddress:e.supplier.address,supplierSubDistrict:e.supplier.subDistric,supplierDistrict:e.supplier.distric,supplierProvince:e.supplier.province,supplierZipCode:e.supplier.zipCode,typeAction:e.typeAction="ฝาก"})),i.value==!0?(h=c,i.value=!1):(d.value=c,u.value.totalPage=t.metadata.totalPage,r.value=!0)):(s.commit("setStatusLoading",!1),r.value=!1,v.value={status:!0,title:"แจ้งเตือน",body:"ไม่พบข้อมูล"},d.value=[]);else{r.value=!1;const e=t.message.map(n=>`<li>${n}</li>`);modalAlert.value={status:!0,title:"กรุณาตรวจสอบ",body:e.join("")},s.commit("setStatusLoading",!1)}})}}else if(a.value.startPeriodDate!=""&&a.value.endPeriodDate!=""){if(console.log("currentDate.value.startPeriodDate --> ",a.value.startPeriodDate),console.log("currentDate.value.endPeriodDate --> ",a.value.endPeriodDate),g()){s.commit("setStatusLoading",!0);const l={page:i.value?1:u.value.page,limit:i.value?1e4:u.value.limit,sortField:"product_specialID",sortType:"ASC",filterModel:{logicOperator:"and",items:[{field:"product_name",operator:"equals",value:m.value.in_productName},{field:"importDeposit_periodDate",operator:"between",value:[a.value.startPeriodDate,a.value.endPeriodDate]}]}};console.log("body --> ",l),await x.exportSearch(l,t=>{if(t.statusCode===200)t.data.length>0?(r.value=!0,f.value=!0,s.commit("setStatusLoading",!1),console.log("_apiDepositExport--> ",t),c=t.data.map(e=>({specialID:e.product.specialID,productName:e.product.name,productInPrice:e.product.price,productOutPrice:e.product.priceOut,priceDeposit:e.Import_Deposit.price,priceTotalDeposit:e.Import_Deposit.price,remain:e.Import_Deposit.remain,quantity_import:e.Import_Deposit.quantity,quantity:e.quantity,periodDate:e.Import_Deposit.periodDate,supplierFirstName:e.supplier.firstName,supplierLastName:e.supplier.lastName,supplierPhone:e.supplier.phone,supplierAddress:e.supplier.address,supplierSubDistrict:e.supplier.subDistric,supplierDistrict:e.supplier.distric,supplierProvince:e.supplier.province,supplierZipCode:e.supplier.zipCode,typeAction:e.typeAction="ฝาก"})),i.value==!0?(h=c,i.value=!1):(d.value=c,u.value.totalPage=t.metadata.totalPage,r.value=!0)):(s.commit("setStatusLoading",!1),r.value=!1,v.value={status:!0,title:"แจ้งเตือน",body:"ไม่พบข้อมูล"},d.value=[]);else{r.value=!1;const e=t.message.map(n=>`<li>${n}</li>`);modalAlert.value={status:!0,title:"กรุณาตรวจสอบ",body:e.join("")},s.commit("setStatusLoading",!1)}})}}else if(a.value.startDate!=""&&a.value.endDate!=""&&a.value.startPeriodDate!=""&&a.value.endPeriodDate!=""){if(g()){s.commit("setStatusLoading",!0);const l={page:i.value?1:u.value.page,limit:i.value?1e4:u.value.limit,sortField:"product_specialID",sortType:"ASC",filterModel:{logicOperator:"and",items:[{field:"product_name",operator:"equals",value:m.value.in_productName},{field:"exportDate",operator:"between",value:[a.value.startDate,a.value.endDate]},{field:"importDeposit_periodDate",operator:"between",value:[a.value.startPeriodDate,a.value.endPeriodDate]}]}};console.log("body --> ",l),await x.exportSearch(l,t=>{if(t.statusCode===200)t.data.length>0?(r.value=!0,f.value=!0,s.commit("setStatusLoading",!1),console.log("_apiDepositExport--> ",t),c=t.data.map(e=>({specialID:e.product.specialID,productName:e.product.name,productInPrice:e.product.price,productOutPrice:e.product.priceOut,priceDeposit:e.Import_Deposit.price,priceTotalDeposit:e.Import_Deposit.price,remain:e.Import_Deposit.remain,quantity_import:e.Import_Deposit.quantity,quantity:e.quantity,periodDate:e.Import_Deposit.periodDate,supplierFirstName:e.supplier.firstName,supplierLastName:e.supplier.lastName,supplierPhone:e.supplier.phone,supplierAddress:e.supplier.address,supplierSubDistrict:e.supplier.subDistric,supplierDistrict:e.supplier.distric,supplierProvince:e.supplier.province,supplierZipCode:e.supplier.zipCode,typeAction:e.typeAction="ฝาก"})),i.value==!0?(h=c,i.value=!1):(d.value=c,u.value.totalPage=t.metadata.totalPage,r.value=!0)):(s.commit("setStatusLoading",!1),r.value=!1,v.value={status:!0,title:"แจ้งเตือน",body:"ไม่พบข้อมูล"},d.value=[]);else{r.value=!1;const e=t.message.map(n=>`<li>${n}</li>`);modalAlert.value={status:!0,title:"กรุณาตรวจสอบ",body:e.join("")},s.commit("setStatusLoading",!1)}})}}else if(a.value.startDate==""&&a.value.endDate==""&&a.value.startPeriodDate==""&&a.value.endPeriodDate==""){if(console.log("ไม่มีค่าวันที่"),g()){s.commit("setStatusLoading",!0);const l={page:i.value?1:u.value.page,limit:i.value?1e4:u.value.limit,sortField:"product_specialID",sortType:"ASC",filterModel:{logicOperator:"and",items:[{field:"product_name",operator:"equals",value:m.value.in_productName}]}};console.log("body --> ",l),await x.exportSearch(l,t=>{if(t.statusCode===200)t.data.length>0?(r.value=!0,f.value=!0,s.commit("setStatusLoading",!1),console.log("_apiDepositExport--> ",t),c=t.data.map(e=>({specialID:e.product.specialID,productName:e.product.name,productInPrice:e.product.price,productOutPrice:e.product.priceOut,priceDeposit:e.Import_Deposit.price,priceTotalDeposit:e.Import_Deposit.price,remain:e.Import_Deposit.remain,quantity_import:e.Import_Deposit.quantity,quantity:e.quantity,periodDate:e.Import_Deposit.periodDate,supplierFirstName:e.supplier.firstName,supplierLastName:e.supplier.lastName,supplierPhone:e.supplier.phone,supplierAddress:e.supplier.address,supplierSubDistrict:e.supplier.subDistric,supplierDistrict:e.supplier.distric,supplierProvince:e.supplier.province,supplierZipCode:e.supplier.zipCode,typeAction:e.typeAction="ฝาก"})),i.value==!0?(h=c,i.value=!1):(d.value=c,u.value.totalPage=t.metadata.totalPage,r.value=!0)):(s.commit("setStatusLoading",!1),r.value=!1,v.value={status:!0,title:"แจ้งเตือน",body:"ไม่พบข้อมูล"},d.value=[]);else{r.value=!1;const e=t.message.map(n=>`<li>${n}</li>`);modalAlert.value={status:!0,title:"กรุณาตรวจสอบ",body:e.join("")},s.commit("setStatusLoading",!1)}})}}else if(a.value.startDate==""&&a.value.endDate==""&&a.value.startPeriodDate==""&&a.value.endPeriodDate==""&&m.value.in_productName==""&&(console.log("ไม่มีค่าวันที่"),g())){s.commit("setStatusLoading",!0);const l={page:i.value?1:u.value.page,limit:i.value?1e4:u.value.limit,sortField:"product_specialID",sortType:"ASC",filterModel:{logicOperator:"and",items:[]}};console.log("body --> ",l),await x.exportSearch(l,t=>{if(t.statusCode===200)t.data.length>0?(r.value=!0,f.value=!0,s.commit("setStatusLoading",!1),console.log("_apiDepositExport--> ",t),c=t.data.map(e=>({specialID:e.product.specialID,productName:e.product.name,productInPrice:e.product.price,productOutPrice:e.product.priceOut,priceDeposit:e.Import_Deposit.price,priceTotalDeposit:e.Import_Deposit.price,remain:e.Import_Deposit.remain,quantity_import:e.Import_Deposit.quantity,quantity:e.quantity,periodDate:e.Import_Deposit.periodDate,supplierFirstName:e.supplier.firstName,supplierLastName:e.supplier.lastName,supplierPhone:e.supplier.phone,supplierAddress:e.supplier.address,supplierSubDistrict:e.supplier.subDistric,supplierDistrict:e.supplier.distric,supplierProvince:e.supplier.province,supplierZipCode:e.supplier.zipCode,typeAction:e.typeAction="ฝาก"})),i.value==!0?(h=c,i.value=!1):(d.value=c,u.value.totalPage=t.metadata.totalPage,r.value=!0)):(s.commit("setStatusLoading",!1),r.value=!1,v.value={status:!0,title:"แจ้งเตือน",body:"ไม่พบข้อมูล"},d.value=[]);else{r.value=!1;const e=t.message.map(n=>`<li>${n}</li>`);modalAlert.value={status:!0,title:"กรุณาตรวจสอบ",body:e.join("")},s.commit("setStatusLoading",!1)}})}}else if(f.value==!1){if(a.value.startDate!=""&&a.value.endDate!=""){if(console.log("currentDate.value.startDate --> ",a.value.startDate),console.log("currentDate.value.endDate --> ",a.value.endDate),g()){s.commit("setStatusLoading",!0);const l={page:i.value?1:u.value.page,limit:i.value?1e4:u.value.limit,sortField:"product_specialID",sortType:"ASC",filterModel:{logicOperator:"and",items:[{field:"product_name",operator:"equals",value:m.value.in_productName},{field:"typeAction",operator:"equals",value:w.value.in_exportType},{field:"exportDate",operator:"between",value:[a.value.startDate,a.value.endDate]}]}};console.log("body --> ",l),await I.search(l,t=>{if(t.statusCode===200)t.data.length>0?(r.value=!0,f.value=!1,s.commit("setStatusLoading",!1),console.log("_apiExport--> ",t),c=t.data.map(e=>({specialID:e.product.specialID,productName:e.product.name,productInPrice:e.product.price,productOutPrice:e.product.priceOut,typeAction:e.typeAction,exportDate:e.exportDate,quantity:e.quantity,priceTotal:e.price,customerFirstName:e.customer.firstName,customerLastName:e.customer.lastName,customerPhone:e.customer.phone,customerAddress:e.customer.address,customerSubDistrict:e.customer.subDistric,customerDistrict:e.customer.distric,customerProvince:e.customer.province,customerZipCode:e.customer.zipCode})),i.value==!0?(h=c,i.value=!1):(d.value=c,u.value.totalPage=t.metadata.totalPage,r.value=!0)):(s.commit("setStatusLoading",!1),r.value=!1,v.value={status:!0,title:"แจ้งเตือน",body:"ไม่พบข้อมูล"},d.value=[]);else{r.value=!1;const e=t.message.map(n=>`<li>${n}</li>`);modalAlert.value={status:!0,title:"กรุณาตรวจสอบ",body:e.join("")},s.commit("setStatusLoading",!1)}})}}else if(a.value.startDate==""&&a.value.endDate==""){if(g()){s.commit("setStatusLoading",!0);const l={page:i.value?1:u.value.page,limit:i.value?1e4:u.value.limit,sortField:"product_specialID",sortType:"ASC",filterModel:{logicOperator:"and",items:[{field:"product_name",operator:"equals",value:m.value.in_productName},{field:"typeAction",operator:"equals",value:w.value.in_exportType}]}};console.log("body--> ",l),await I.search(l,t=>{if(t.statusCode===200)t.data.length>0?(r.value=!0,f.value=!1,s.commit("setStatusLoading",!1),console.log("name&typeAction--> ",t),c=t.data.map(e=>({specialID:e.product.specialID,productName:e.product.name,productInPrice:e.product.price,productOutPrice:e.product.priceOut,typeAction:e.typeAction,exportDate:e.exportDate,quantity:e.quantity,priceTotal:e.price,customerFirstName:e.customer.firstName,customerLastName:e.customer.lastName,customerPhone:e.customer.phone,customerAddress:e.customer.address,customerSubDistrict:e.customer.subDistric,customerDistrict:e.customer.distric,customerProvince:e.customer.province,customerZipCode:e.customer.zipCode})),i.value==!0?(h=c,i.value=!1):(d.value=c,u.value.totalPage=t.metadata.totalPage,r.value=!0)):(s.commit("setStatusLoading",!1),r.value=!1,v.value={status:!0,title:"แจ้งเตือน",body:"ไม่พบข้อมูล"},d.value=[]);else{r.value=!1;const e=t.message.map(n=>`<li>${n}</li>`);modalAlert.value={status:!0,title:"กรุณาตรวจสอบ",body:e.join("")},s.commit("setStatusLoading",!1)}})}}else if(a.value.startDate==""&&a.value.endDate==""&&m.value.in_productName==""&&g()){s.commit("setStatusLoading",!0);const l={page:i.value?1:u.value.page,limit:i.value?1e4:u.value.limit,sortField:"product_specialID",sortType:"ASC",filterModel:{logicOperator:"and",items:[{field:"typeAction",operator:"equals",value:w.value.in_exportType}]}};console.log("body--> ",l),await I.search(l,t=>{if(t.statusCode===200)t.data.length>0?(r.value=!0,f.value=!1,s.commit("setStatusLoading",!1),console.log("_apiExporttttttt--> ",t),c=t.data.map(e=>({specialID:e.product.specialID,productName:e.product.name,productInPrice:e.product.price,productOutPrice:e.product.priceOut,typeAction:e.typeAction,exportDate:e.exportDate,quantity:e.quantity,priceTotal:e.price,customerFirstName:e.customer.firstName,customerLastName:e.customer.lastName,customerPhone:e.customer.phone,customerAddress:e.customer.address,customerSubDistrict:e.customer.subDistric,customerDistrict:e.customer.distric,customerProvince:e.customer.province,customerZipCode:e.customer.zipCode})),i.value==!0?(h=c,i.value=!1):(d.value=c,u.value.totalPage=t.metadata.totalPage,r.value=!0)):(s.commit("setStatusLoading",!1),r.value=!1,v.value={status:!0,title:"แจ้งเตือน",body:"ไม่พบข้อมูล"});else{r.value=!1;const e=t.message.map(n=>`<li>${n}</li>`);modalAlert.value={status:!0,title:"กรุณาตรวจสอบ",body:e.join("")},s.commit("setStatusLoading",!1)}})}}},L=async()=>{await k()},g=()=>{console.log("***CheckCurrentDate***");let p=!0;return a.value.startDate>a.value.endDate?(v.value={status:!0,title:"เกิดข้อผิดพลาด",body:"วันที่เริ่มต้นต้องน้อยกว่าวันที่สิ้นสุด"},a.value.startDate="",a.value.endDate="",d.value=[],p=!1):a.value.endDate<a.value.startDate?(v.value={status:!0,title:"เกิดข้อผิดพลาด",body:"วันที่สิ้นสุดต้องมากกว่าวันที่เริ่มต้น"},a.value.startDate="",a.value.endDate="",d.value=[],p=!1):a.value.startDate!=""&&a.value.endDate==""?(v.value={status:!0,title:"เกิดข้อผิดพลาด",body:"กรุณากรอกวันที่สิ้นสุด"},a.value.startDate="",a.value.endDate="",d.value=[],p=!1):a.value.startDate==""&&a.value.endDate!=""&&(v.value={status:!0,title:"เกิดข้อผิดพลาด",body:"กรุณากรอกวันที่เริ่มต้น"},a.value.startDate="",a.value.endDate="",d.value=[],p=!1),a.value.startPeriodDate>a.value.endPeriodDate?(v.value={status:!0,title:"เกิดข้อผิดพลาด",body:"วันที่เริ่มต้นต้องน้อยกว่าวันที่สิ้นสุด"},a.value.startPeriodDate="",a.value.endPeriodDate="",d.value=[],p=!1):a.value.endPeriodDate<a.value.startPeriodDate?(v.value={status:!0,title:"เกิดข้อผิดพลาด",body:"วันที่สิ้นสุดต้องมากกว่าวันที่เริ่มต้น"},a.value.startPeriodDate="",a.value.endPeriodDate="",d.value=[],p=!1):a.value.startPeriodDate!=""&&a.value.endPeriodDate==""?(v.value={status:!0,title:"เกิดข้อผิดพลาด",body:"กรุณากรอกวันที่สิ้นสุด"},a.value.startPeriodDate="",a.value.endPeriodDate="",d.value=[],p=!1):a.value.startPeriodDate==""&&a.value.endPeriodDate!=""&&(v.value={status:!0,title:"เกิดข้อผิดพลาด",body:"กรุณากรอกวันที่เริ่มต้น"},p=!1),p},H=()=>{d.value=[],r.value=!1,f.value=!1,m.value.in_productName="",w.value.in_exportType="ซื้อ-ขาย",a.value.startDate="",a.value.endDate="",a.value.startPeriodDate="",a.value.endPeriodDate=""},z=()=>{d.value=[],r.value=!1,w.value.in_exportType=="ฝาก"?f.value=!0:f.value=!1};U(async()=>{s.commit("setStatusLoading",!0),await R(),s.commit("setStatusLoading",!1)});const B=async()=>{console.log("***onExportExcel***");const p=new Y.Workbook,l=p.addWorksheet("Sheet A");i.value=!0,await k(),f.value==!0?(l.columns=[{header:"รหัสสินค้า",key:"specialID",width:15},{header:"ชื่อสินค้า",key:"productName",width:30},{header:"ประเภทสินค้า",key:"typeAction",width:20},{header:"ปริมาณฝากเข้า",key:"quantity_import",width:15},{header:"ราคารับซื้อ",key:"productInPrice",width:15},{header:"ราคาขายออก",key:"productOutPrice",width:15},{header:"ค่าฝาก",key:"priceDeposit",width:15},{header:"ปริมาณการขาย",key:"quantity",width:15},{header:"ประมาณคงเหลือ",key:"remain",width:15},{header:"รวมทั้งสิ้น",key:"priceTotalDeposit",width:15},{header:"วันที่สิ้นสุดการฝาก",key:"periodDate",width:15},{header:"ชื่อ",key:"supplierFirstName",width:15},{header:"สกุล",key:"supplierLastName",width:15},{header:"เบอร์โทร",key:"supplierPhone",width:15},{header:"ที่อยู่",key:"supplierAddress",width:30},{header:"ตำบล",key:"supplierSubDistrict",width:15},{header:"อำเภอ",key:"supplierDistrict",width:15},{header:"จังหวัด",key:"supplierProvince",width:15},{header:"ไปรษณีย์",key:"supplierZipCode",width:15}],l.getRow(1).eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"DD5746"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),h.forEach((e,n)=>{l.addRow({specialID:e.specialID,productName:e.productName,productInPrice:e.productInPrice,productOutPrice:e.productOutPrice,priceDeposit:e.priceDeposit,priceTotalDeposit:e.priceTotalDeposit,remain:e.remain,quantity_import:e.quantity_import,quantity:e.quantity,periodDate:e.periodDate,supplierFirstName:e.supplierFirstName,supplierLastName:e.supplierLastName,supplierPhone:e.supplierPhone,supplierAddress:e.supplierAddress,supplierSubDistrict:e.supplierSubDistrict,supplierDistrict:e.supplierDistrict,supplierProvince:e.supplierProvince,supplierZipCode:e.supplierZipCode,typeAction:e.typeAction}).eachCell(D=>{D.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),p.xlsx.writeBuffer().then(e=>{const n=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),C=window.URL.createObjectURL(n),D=document.createElement("a");D.href=C,D.download="ExportedDataDeposit.xlsx",D.click()})):(l.columns=[{header:"รหัสสินค้า",key:"specialID",width:15},{header:"ชื่อสินค้า",key:"productName",width:30},{header:"ประเภทสินค้า",key:"typeAction",width:20},{header:"ราคารับซื้อ",key:"productInPrice",width:15},{header:"ราคาขายออก",key:"productOutPrice",width:15},{header:"ปริมาณการขาย",key:"quantity",width:15},{header:"รวมทั้งสิ้น",key:"priceTotal",width:15},{header:"วันที่นำออก",key:"exportDate",width:15},{header:"ชื่อ",key:"customerFirstName",width:15},{header:"สกุล",key:"customerLastName",width:15},{header:"เบอร์โทร",key:"customerPhone",width:15},{header:"ที่อยู่",key:"customerAddress",width:30},{header:"ตำบล",key:"customerSubDistrict",width:15},{header:"อำเภอ",key:"customerDistrict",width:15},{header:"จังหวัด",key:"customerProvince",width:15},{header:"ไปรษณีย์",key:"customerZipCode",width:15}],l.getRow(1).eachCell(e=>{e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"A8CD9F"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}}),h.forEach((e,n)=>{l.addRow({specialID:e.specialID,productName:e.productName,productInPrice:e.productInPrice,productOutPrice:e.productOutPrice,typeAction:e.typeAction,exportDate:e.exportDate,quantity:e.quantity,priceTotal:e.priceTotal,customerFirstName:e.customerFirstName,customerLastName:e.customerLastName,customerPhone:e.customerPhone,customerAddress:e.customerAddress,customerSubDistrict:e.customerSubDistrict,customerDistrict:e.customerDistrict,customerProvince:e.customerProvince,customerZipCode:e.customerZipCode}).eachCell(D=>{D.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),p.xlsx.writeBuffer().then(e=>{const n=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),C=window.URL.createObjectURL(n),D=document.createElement("a");D.href=C,D.download="ExportedData2.xlsx",D.click()}))};return(p,l)=>(b(),_(V,null,[o("div",ee,[o("div",te,[ae,o("div",le,[o("div",oe,[o("div",re,[o("div",se,[ie,P(o("select",{"onUpdate:modelValue":l[0]||(l[0]=t=>m.value.in_productName=t),class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3"},[(b(!0),_(V,null,G(m.value,(t,e)=>(b(),_("option",{key:e,value:t.productName},K(t.productName),9,ue))),128))],512),[[q,m.value.in_productName]])]),o("div",de,[pe,P(o("select",{onChange:z,"onUpdate:modelValue":l[1]||(l[1]=t=>w.value.in_exportType=t),class:"h-8 w-50 focus:outline-red-400 rounded bg-red-100 px-3"},fe,544),[[q,w.value.in_exportType]])]),o("div",me,[De,P(o("input",{class:"h-8 w-50 focus:outline-red-400 rounded bg-red-100 px-3",type:"date","onUpdate:modelValue":l[2]||(l[2]=t=>a.value.startDate=t)},null,512),[[N,a.value.startDate]])]),o("div",he,[ye,P(o("input",{class:"h-8 w-50 focus:outline-red-400 rounded bg-red-100 px-3",type:"date","onUpdate:modelValue":l[3]||(l[3]=t=>a.value.endDate=t)},null,512),[[N,a.value.endDate]])])]),f.value?(b(),_("div",ge,[o("div",be,[we,P(o("input",{class:"h-8 w-50 focus:outline-red-400 rounded bg-red-100 px-3",type:"date","onUpdate:modelValue":l[4]||(l[4]=t=>a.value.startPeriodDate=t)},null,512),[[N,a.value.startPeriodDate]])]),o("div",_e,[Pe,P(o("input",{class:"h-8 w-50 focus:outline-red-400 rounded bg-red-100 px-3",type:"date","onUpdate:modelValue":l[5]||(l[5]=t=>a.value.endPeriodDate=t)},null,512),[[N,a.value.endPeriodDate]])])])):S("",!0),o("div",Ce,[o("button",{label:"ค้นหา",onClick:L,class:"h-10 rounded-full w-40 btn btn-btn-error btn-wide text-xl text-red-800 font-semibold"},[xe,A(" ค้นหา ")]),o("button",{onClick:H,class:"h-10 rounded-full w-40 btn btn-btn-error btn-wide text-xl text-red-800 font-semibold"},[Ne,A(" ยกเลิก ")]),r.value?(b(),_("button",{key:0,onClick:B,class:"h-10 rounded-full w-40 btn btn-btn-error btn-wide text-xl text-red-800 font-semibold"},[Se,A(" รายงาน ")])):S("",!0)])])])])]),r.value?(b(),_("div",Ae,[o("div",Ie,[f.value?(b(),T(F,{key:0,columns:j,rows:d.value},null,8,["rows"])):(b(),T(F,{key:1,columns:Z,rows:d.value},null,8,["rows"]))]),o("div",ke,[O(Q,{currentPage:u.value.page,"onUpdate:currentPage":[l[6]||(l[6]=t=>u.value.page=t),M],totalPages:u.value.totalPage,limit:u.value.limit},null,8,["currentPage","totalPages","limit"])])])):S("",!0),O(W,{titleMessage:v.value.title,bodyMessage:v.value.body,status:v.value.status,onCloseAlertModal:E},null,8,["titleMessage","bodyMessage","status"])],64))}};export{je as default};
