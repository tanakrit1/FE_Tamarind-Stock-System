import{r as v,o as Q,v as D,f as _,j as p,k as e,l as h,D as N,x as r,A as g,B as R,y as k,F as A,z as U,C as W}from"./index-BfEDlx2e.js";import{b as F,_ as X,a as Y}from"./pagination-page-BpupLFiI.js";import{_ as Z}from"./button-primary-outline-DA8sDgzx.js";import{p as V,d as z,s as y}from"./thai_provinces-BD6VM2Cq.js";import{_ as I}from"./master-supplier-DzAwSHkr.js";const ee={class:"flex md:justify-center"},te={class:"sm:w-1/1 md:w-2/3 flex flex-col mb-10 space-y-10"},se={class:"flex justify-between"},ie=e("div",{class:"flex space-x-3"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 20 20"},[e("path",{fill:"#A2422C",d:"M17 7v2.401a3 3 0 0 0-3.727 4.609A2.5 2.5 0 0 0 11 16.5q0 .25.038.5H5.5A2.5 2.5 0 0 1 3 14.5V7zm-2.5-4A2.5 2.5 0 0 1 17 5.5V6H3v-.5A2.5 2.5 0 0 1 5.5 3zm3 9a2 2 0 1 1-4 0a2 2 0 0 1 4 0m1.5 4.5c0 1.245-1 2.5-3.5 2.5S12 17.75 12 16.5a1.5 1.5 0 0 1 1.5-1.5h4a1.5 1.5 0 0 1 1.5 1.5"})]),e("span",{class:"text-2xl font-bold text-red-800"},"กำหนดข้อมูลผู้จัดจำหน่าย")],-1),le={class:"flex space-x-3"},ae={class:"rounded-xl mb-10 overflow-auto"},oe={class:"flex justify-end"},ne={id:"modal-supplier",class:"modal"},de={class:"modal-box w-11/12 max-w-3xl"},ue={class:"font-bold text-lg"},re=e("hr",{class:"mt-2",style:{border:"1px solid #c2796a"}},null,-1),ce={class:"py-4 flex flex-wrap"},_e={key:0,class:"basis-1/2 px-3 space-y-2 mb-3"},pe=e("label",{class:"font-semibold"},"รหัสผู้จัดจำหน่าย",-1),ve=e("br",null,null,-1),me={class:"basis-1/2 px-3 space-y-2 mb-3"},be=e("label",{class:"font-semibold"},"ชื่อ",-1),fe=e("br",null,null,-1),he={class:"basis-1/2 px-3 space-y-2 mb-3"},ge=e("label",{class:"font-semibold"},"สกุล",-1),xe=e("br",null,null,-1),ye={class:"basis-1/2 px-3 space-y-2 mb-3"},we=e("label",{class:"font-semibold"},"เบอร์โทร",-1),Ce=e("br",null,null,-1),De={class:"basis-1/2 px-3 space-y-2 mb-3"},Ne=e("label",{class:"font-semibold"},"ที่อยู่",-1),Ve=e("br",null,null,-1),ze={class:"basis-1/2 px-3 space-y-2 mb-3"},Me=e("label",{class:"font-semibold"},"จังหวัด",-1),Se=e("br",null,null,-1),Pe=e("option",{value:""},"------เลือก------",-1),ke=["value"],Ae={class:"basis-1/2 px-3 space-y-2 mb-3"},Ue=e("label",{class:"font-semibold"},"อำเภอ",-1),Ie=e("br",null,null,-1),$e=e("option",{value:""},"------เลือก------",-1),Be=["value"],je={class:"basis-1/2 px-3 space-y-2 mb-3"},Ee=e("label",{class:"font-semibold"},"ตำบล",-1),Le=e("br",null,null,-1),Fe=e("option",{value:""},"------เลือก------",-1),He=["value"],Oe={class:"basis-1/2 px-3 space-y-2 mb-3"},qe=e("label",{class:"font-semibold"},"รหัสไปรษณีย์",-1),Te=e("br",null,null,-1),Ge={class:"modal-action"},Ye={__name:"index",setup(Je){const c=v({page:1,limit:5,totalPage:0}),H=[{field:"specialID",label:"รหัส",width:"10%"},{field:"firstName",label:"ชื่อ",width:"15%"},{field:"lastName",label:"สกุล",width:"15%"},{field:"address",label:"ที่อยู่",width:"15%"},{field:"subDistric",label:"ตำบล",width:"15%"},{field:"distric",label:"อำเภอ",width:"15%"},{field:"province",label:"จังหวัด",width:"15%"},{field:"zipCode",label:"ไปรษณีย์",width:"10%"}],$=v([]),u=v({status:!1,title:"",body:""}),w=v("add"),o=v(null),m=v({province:[],district:[],subDistrict:[]}),i=v({in_specialID:"",in_firstName:"",in_lastName:"",in_phone:"",in_province:"",in_district:"",in_subDistrict:"",in_zipCode:"",in_address:""});Q(async()=>{D.commit("setStatusLoading",!0),m.value.province=V.sort((l,s)=>l.name_th.localeCompare(s.name_th)),await C(),u.value={status:!1,title:"",body:""},D.commit("setStatusLoading",!1)});const O=()=>{u.value.status=!1},q=()=>{i.value={in_specialID:"",in_firstName:"",in_lastName:"",in_phone:"",in_province:"",in_district:"",in_subDistrict:"",in_zipCode:"",in_address:""}},C=async()=>{const l={page:c.value.page,limit:c.value.limit};await I.search(l,s=>{$.value=s.data,c.value.totalPage=s.metadata.totalPage})},T=l=>{c.value.page=l,C()},B=async l=>{const s=z.filter(t=>t.province_id==l);m.value.district=s,i.value.in_district="",i.value.in_subDistrict="",i.value.in_zipCode=""},j=async l=>{const s=y.filter(t=>t.amphure_id==l);console.log("filterSubDistrict---> ",s),m.value.subDistrict=s,i.value.in_subDistrict="",i.value.in_zipCode=""},E=async l=>{const s=y.find(t=>t.id==l).zip_code;i.value.in_zipCode=s},G=l=>{o.value=l,L("edit")},L=async l=>{var s,t,n;if(console.log("rowAction--> ",o.value),w.value=l,l==="add")q();else{const b=(s=V.find(d=>d.name_th==o.value.province))==null?void 0:s.id,f=(t=z.find(d=>d.name_th==o.value.distric&&d.province_id==b))==null?void 0:t.id,x=(n=y.find(d=>d.name_th==o.value.subDistric&&d.amphure_id==f))==null?void 0:n.id;await B(b),await j(f),await E(x),i.value={in_specialID:o.value.specialID,in_firstName:o.value.firstName,in_lastName:o.value.lastName,in_phone:o.value.phone,in_province:b,in_district:f,in_subDistrict:x,in_zipCode:o.value.zipCode,in_address:o.value.address}}document.getElementById("modal-supplier").showModal()},J=async()=>{var s,t,n,b,f,x;D.commit("setStatusLoading",!0);const l=K();if(console.log("resultValidatePhone--> ",l),l)if(w.value==="add"){const d={firstName:i.value.in_firstName,lastName:i.value.in_lastName,address:i.value.in_address,subDistric:((s=y.find(a=>a.id==i.value.in_subDistrict))==null?void 0:s.name_th)||"",distric:((t=z.find(a=>a.id==i.value.in_district))==null?void 0:t.name_th)||"",province:((n=V.find(a=>a.id==i.value.in_province))==null?void 0:n.name_th)||"",zipCode:i.value.in_zipCode.toString(),phone:i.value.in_phone.toString()};await I.create(d,async a=>{if(a.statusCode===200)u.value={status:!0,title:"สำเร็จ",body:"บันทึกข้อมูลสำเร็จ"},M(),await C();else{const S=a.message.map(P=>`<li>${P}</li>`);u.value={status:!0,title:"กรุณาตรวจสอบ",body:S.join("")}}})}else{const d={firstName:i.value.in_firstName,lastName:i.value.in_lastName,address:i.value.in_address,subDistric:((b=y.find(a=>a.id==i.value.in_subDistrict))==null?void 0:b.name_th)||"",distric:((f=z.find(a=>a.id==i.value.in_district))==null?void 0:f.name_th)||"",province:((x=V.find(a=>a.id==i.value.in_province))==null?void 0:x.name_th)||"",zipCode:i.value.in_zipCode.toString(),phone:i.value.in_phone.toString()};await I.update(d,o.value.id,async a=>{if(a.statusCode===200)u.value={status:!0,title:"สำเร็จ",body:"บันทึกข้อมูลสำเร็จ"},M(),await C();else{const S=a.message.map(P=>`<li>${P}</li>`);u.value={status:!0,title:"กรุณาตรวจสอบ",body:S.join("")}}})}else u.value={status:!0,title:"กรุณาตรวจสอบ",body:"ข้อมูลเบอร์โทรศัพท์ไม่ถูกต้อง"};D.commit("setStatusLoading",!1)},M=()=>{document.getElementById("modal-supplier").close()},K=()=>!isNaN(Number(i.value.in_phone));return(l,s)=>(_(),p("div",null,[e("div",ee,[e("div",te,[e("div",se,[ie,e("div",le,[h(F,{label:"เพิ่มผู้จัดจำหน่าย",icon:"plus",onClick:s[0]||(s[0]=t=>L("add"))})])]),e("div",ae,[h(X,{columns:H,rows:$.value,rowEdit:!0,onOnClickEdit:G},null,8,["rows"])]),e("div",oe,[h(Y,{currentPage:c.value.page,"onUpdate:currentPage":[s[1]||(s[1]=t=>c.value.page=t),T],totalPages:c.value.totalPage,limit:c.value.limit},null,8,["currentPage","totalPages","limit"])])])]),e("dialog",ne,[e("div",de,[e("h3",ue,N(w.value==="add"?"เพิ่มผู้จัดจำหน่าย":"แก้ไขผู้จัดจำหน่าย"),1),re,e("div",ce,[w.value==="edit"?(_(),p("div",_e,[pe,ve,r(e("input",{disabled:"","onUpdate:modelValue":s[2]||(s[2]=t=>i.value.in_specialID=t),type:"text",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3"},null,512),[[g,i.value.in_specialID]])])):R("",!0),e("div",me,[be,fe,r(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>i.value.in_firstName=t),type:"text",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3"},null,512),[[g,i.value.in_firstName]])]),e("div",he,[ge,xe,r(e("input",{"onUpdate:modelValue":s[4]||(s[4]=t=>i.value.in_lastName=t),type:"text",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3"},null,512),[[g,i.value.in_lastName]])]),e("div",ye,[we,Ce,r(e("input",{"onUpdate:modelValue":s[5]||(s[5]=t=>i.value.in_phone=t),type:"text",maxlength:"10",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3"},null,512),[[g,i.value.in_phone]])]),e("div",De,[Ne,Ve,r(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>i.value.in_address=t),type:"text",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3"},null,512),[[g,i.value.in_address]])]),e("div",ze,[Me,Se,r(e("select",{"onUpdate:modelValue":s[7]||(s[7]=t=>i.value.in_province=t),class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3",onChange:s[8]||(s[8]=t=>B(t.target.value))},[Pe,(_(!0),p(A,null,U(m.value.province,(t,n)=>(_(),p("option",{key:n,value:t.id},N(t.name_th),9,ke))),128))],544),[[k,i.value.in_province]])]),e("div",Ae,[Ue,Ie,r(e("select",{"onUpdate:modelValue":s[9]||(s[9]=t=>i.value.in_district=t),class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3",onChange:s[10]||(s[10]=t=>j(t.target.value))},[$e,(_(!0),p(A,null,U(m.value.district,(t,n)=>(_(),p("option",{key:n,value:t.id},N(t.name_th),9,Be))),128))],544),[[k,i.value.in_district]])]),e("div",je,[Ee,Le,r(e("select",{"onUpdate:modelValue":s[11]||(s[11]=t=>i.value.in_subDistrict=t),class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3",onChange:s[12]||(s[12]=t=>E(t.target.value))},[Fe,(_(!0),p(A,null,U(m.value.subDistrict,(t,n)=>(_(),p("option",{key:n,value:t.id},N(t.name_th),9,He))),128))],544),[[k,i.value.in_subDistrict]])]),e("div",Oe,[qe,Te,r(e("input",{"onUpdate:modelValue":s[13]||(s[13]=t=>i.value.in_zipCode=t),type:"text",class:"h-8 w-full focus:outline-red-400 rounded bg-red-100 px-3",readonly:""},null,512),[[g,i.value.in_zipCode]])])]),e("div",Ge,[h(F,{label:"เพิ่ม",onClick:J}),h(Z,{label:"ปิด",onClick:M})])])]),h(W,{titleMessage:u.value.title,bodyMessage:u.value.body,status:u.value.status,onCloseAlertModal:O},null,8,["titleMessage","bodyMessage","status"])]))}};export{Ye as default};
